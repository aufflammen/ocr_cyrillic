# OCR cyrillic

**Цель проекта:** разработать модель для распознавания русскоязычного текста на фотографиях или отсканированных изображениях из книг.  

**Основные этапы работ:**
1. Создание тестового датасета на основе реальных данных.
2. Создание синтетических тренировочных наборов данныч на основе сгенерированных изображений для моделей распознавания и детекции.
3. Обучение на полученных данных recognition model и detection model.
4. Объединение обученных моделей и проведение тестирования. Сравнение результатов с готовыми решениями.

В проекте использовались модели из библиотеки: **[docTR](https://github.com/mindee/doctr)**.

### Структура проекта
| Файл | Описание |
| --- | --- |
| **[castom_utils.py](castom_utils.py)** | Кастомные функции, используемые в нескольких ноутбуках. |
| **[config.yaml](config.yaml)** | Конфигурационный файл. Можно отредактировать вручную или из ноутбука [ocr_cyrillic_project.ipynb](ocr_cyrillic_project.ipynb). |
| **[pdf_to_images.ipynb](pdf_to_images.ipynb)** | Скрипт для конвертации PDF файлов с текстовым слоем в отдельные изображения и текст. Можно применять для создания тестового датасета. |
| **[synthetic_datasets.ipynb](synthetic_datasets.ipynb)** | В данном ноутбуке реализован парсинг и предобработка текста а так же создание на его основе синтетических датасетов из изображений для обучения моделей распознавания и детекции. |
| **[train_recognition.ipynb](train_recognition.ipynb)** | Обучение модели распознавания текста. |
| **[train_detection.ipynb](train_detection.ipynb)** | Обучение модели детекции текста. |
| **[ocr_cyrillic.ipynb](ocr_cyrillic.ipynb)** | Объединение ранее обученных моделей в одну OCR модель и тестирование на реальных данных. Сравнение результатов с готовыми решениями для работы с русскоязычным текстом (EasyOCR, Tesseract, PaddleOCR).|


### Stack
`torch`, `torchvision`, `doctr`, `albumentations`, `pillow`, `opencv`.